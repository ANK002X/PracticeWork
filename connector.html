<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="https://raw.githubusercontent.com/tableau/webdataconnector/master/dist/wdc.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      (function () {
        var myConnector = tableau.makeConnector();
        myConnector.getData = function (request, doneCallback) {
          var apiUrl = 'https://data.cityofchicago.org/resource/x2n5-8w5q.csv?$order=id&$limit=10000&$offset=0';

          // Fetch CSV data from the API
          $.get(apiUrl, function (data) {
            var tableData = [];
            // Assuming data is in CSV format, process it into tableData
            data.forEach(function (row) {
              tableData.push({
                id: row.id,
                name: row.name,
                // Include any other fields you need
              });
            });
            // Respond to Tableau with the data
            request.respond(tableData);
            doneCallback();
          });
        };

        tableau.registerConnector(myConnector);
      })();
    </script>
  </body>
</html>
